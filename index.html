<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tic Tac Toe Online</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #000;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    h1 {
      color: orange;
    }
    #board {
      display: grid;
      gap: 5px;
      margin: 20px;
    }
    .cell {
      width: 60px;
      height: 60px;
      font-size: 2em;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #222;
      border-radius: 10px;
      cursor: pointer;
    }
    .cell.X { background: #3498db; }
    .cell.O { background: #e74c3c; }
    .controls, #status, #scoreboard {
      margin-top: 10px;
    }
    input, button {
      margin: 5px;
      padding: 5px;
      font-size: 1em;
    }
  </style>
  <script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, get } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";const firebaseConfig = {
  apiKey: "AIzaSyA-eaOYQ9PUUlr8OtdI68p40XVzmBtl3Ho",
  authDomain: "tic-tac-toe-e6f3e.firebaseapp.com",
  databaseURL: "https://tic-tac-toe-e6f3e-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "tic-tac-toe-e6f3e",
  storageBucket: "tic-tac-toe-e6f3e.firebasestorage.app",
  messagingSenderId: "178093860272",
  appId: "1:178093860272:web:3adbb9360d7cf87ef2a275",
  measurementId: "G-WK8PDPYHXH"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const gameId = prompt("Masukkan ID Game (bebas, bisa dibagikan ke teman):");
const player = prompt("Masukkan simbol (X atau O):");

const boardRef = ref(db, `games/${gameId}/board`);
const turnRef = ref(db, `games/${gameId}/turn`);
const scoreRef = ref(db, `games/${gameId}/score`);

const boardSize = 3;
const boardEl = document.getElementById("board");
const statusEl = document.getElementById("status");
const scoreEl = document.getElementById("score");
let board = Array(boardSize).fill().map(() => Array(boardSize).fill(""));
let currentTurn = "X";
let scores = { X: 0, O: 0 };

function renderBoard() {
  boardEl.innerHTML = '';
  boardEl.style.gridTemplateColumns = `repeat(${boardSize}, 1fr)`;
  board.forEach((row, i) => {
    row.forEach((cell, j) => {
      const div = document.createElement("div");
      div.className = `cell ${cell}`;
      div.textContent = cell;
      div.onclick = () => makeMove(i, j);
      boardEl.appendChild(div);
    });
  });
}

function makeMove(i, j) {
  if (board[i][j] || currentTurn !== player) return;
  board[i][j] = player;
  currentTurn = player === "X" ? "O" : "X";
  set(boardRef, board);
  set(turnRef, currentTurn);
}

function checkWin() {
  const lines = [
    // Rows & Columns
    ...board,
    ...board[0].map((_, col) => board.map(row => row[col])),
    // Diagonals
    board.map((row, i) => board[i][i]),
    board.map((row, i) => board[i][boardSize - 1 - i])
  ];
  for (const line of lines) {
    if (line.every(cell => cell === "X")) return "X";
    if (line.every(cell => cell === "O")) return "O";
  }
  return null;
}

function updateScore(winner) {
  scores[winner]++;
  set(scoreRef, scores);
}

onValue(boardRef, snapshot => {
  if (snapshot.exists()) {
    board = snapshot.val();
    renderBoard();
    const winner = checkWin();
    if (winner) {
      alert(`${winner} menang!`);
      updateScore(winner);
      board = Array(boardSize).fill().map(() => Array(boardSize).fill(""));
      set(boardRef, board);
    }
  }
});

onValue(turnRef, snapshot => {
  if (snapshot.exists()) {
    currentTurn = snapshot.val();
    statusEl.textContent = `Giliran: ${currentTurn}`;
  }
});

onValue(scoreRef, snapshot => {
  if (snapshot.exists()) {
    scores = snapshot.val();
    scoreEl.textContent = `Skor - X: ${scores.X}, O: ${scores.O}`;
  }
});

// Init
set(boardRef, board);
set(turnRef, currentTurn);
set(scoreRef, scores);
renderBoard();

  </script>
</head>
<body>
  <h1>Tic Tac Toe Online</h1>
  <div id="status">Giliran: X</div>
  <div id="scoreboard"><span id="score">Skor - X: 0, O: 0</span></div>
  <div id="board"></div>
</body>
</html>
